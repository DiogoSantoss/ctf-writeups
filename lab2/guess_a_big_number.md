# Challenge `Guess a BIG Number` Writeup

- Vulnerability: 
  - brute-force attack
- Where:
  - `/guess/number` endpoint
- Impact:
  - allows to find the server's guess by enumeration

## Analyzing the server

This challenges consists in guessing a random number generated by the server.
By sending a request to `/guess/number` endpoint, the server responds either with `Higher!` or `Lower!`.
The server's session is associated with a cookie, so all requests must be sent with it.

## Exploit

First send a request to `/` to obtain a cookie.
```python
session = requests.session()
session.get(URL)
```
Then use a binary search to find the server's guess. Knowing the boundaries of the hidden value, set `min` to `0` and `max` to `100000`.
From here compute the guess as the middle of the interval.
> Note: Technically `min` and `max` values are unknown since all it's said is that there are 100.000 possibilities for the correct guess.
```python
number = (min+max)//2
r = session.get(URL + "/number/" + str(number))
```
If the server responds with `Higher!`, set the `min` value to be equal to `number` else set the `max` value to be equal to `number`.
```python	
if r.text.find("Higher!") != -1:
    min = number
elif r.text.find("Lower!") != -1:
    max = number
```
Repeat this process until the server responds with the flag `SSof{A_little_scripting_is_all_you_need}`.
> Note: Usually brute-force attacks are linear in complexity, but since we use a binary search, the complexity is logarithmic.

## Implementation

These code snippets and full implementation can be found [here](guess_a_big_number.py).
